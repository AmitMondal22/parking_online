<div class="container-fluid">
  <div class="row">
    <div class="card col-12">
      <div class="card-body">
        <div class="titleSec">
          <button type="button" class="btn btn-primary" id="myBtn"
            style="float: inline-end;border-radius: 6px;width: 6vw;">Add</button>
        </div>
        <div class="row mt-4">
          <h2 class="text-dark">Header & Footer</h2>
        </div>
        <div class="row mt-3">
          <div class="form-group col-7">
            <label for="cust_name"><b class="text-dark">Customer Name:</b></label>
            <select name="cust_name" class="form-control" id="cust_name" required>
              <option value="" class="text-dark">Select Customer Name</option>
              <% data.msg.forEach(function(item2,index) { %>
                <option value="<%=item2.customer_id%>">
                  <%=item2.customer_name%>
                </option>
                <% }); %>
            </select>
          </div>
        </div>
        <div class="table-responsive">
          <table id="example" class="table table-striped table-bordered show_data" style="width:100%">
            <thead>
              <tr>
                <th class="text-dark">Sl. No.</th>
                <th class="text-dark">Cust Name</th>
                <th class="text-dark">Header1 Flag</th>
                <th class="text-dark">Header2 Flag</th>
                <th class="text-dark">Header3 Flag</th>
                <th class="text-dark">Header4 Flag</th>
                <th class="text-dark">Footer1 Flag</th>
                <th class="text-dark">Footer2 Flag</th>
                <th class="text-dark">Footer3 Flag</th>
                <th class="text-dark">Footer4 Flag</th>
                <th class="text-dark">IN on/off Flag</th>
                <th class="text-dark">OUT on/off Flag</th>
                <th class="text-dark">Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="13" class="text-danger text-center">No Data Found</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<link href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/css/bootstrap4-toggle.min.css"
  rel="stylesheet">
<script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/js/bootstrap4-toggle.min.js"></script>

<div class="modal fade" id="myModal">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h3 class="modal-title text-dark"><b>Add Header & Footer</b></h3>
        <button type="button" class="close" data-dismiss="modal">
          &times;
        </button>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <form action="/header/add_header_footer" method="post" id="myForm">
          <div class="row">
            <div class="form-group col-9">
              <label for="cust_id" class="text-dark"><b>Customer Name:</b></label>
              <select name="cust_id" class="form-control" id="cust_id">
                <option value="" selected>
                  <%= user.user_data.customer_name %>
                </option>
              </select>
            </div>

            <div class="col-md-9">
              <div class="form-group">
                <label for="header_1" class="text-dark"><b>Header 1</b>&nbsp;&nbsp;<span id="charCount1"
                    class="char-count"><b>(0/25)</b></span></label>
                <textarea class="form-control" id="header_1" name="header_1" rows="2" placeholder="Enter Header1...."
                  maxlength="25" oninput="updateCharCount('header_1','charCount1')"></textarea>
              </div>
            </div>
            <div class="col-md-3 cust-toggle1">
              <label for="header_1_flag" class="text-dark"><b>Header 1 Flag</b></label><br>
              <input type="checkbox" value=1 id="header_1_flag" data-toggle="toggle" data-onstyle="success"
                data-offstyle="danger" data-on="Active" data-off="Deactive" name="header_1_flag">
            </div>

            <div class="col-md-9">
              <div class="form-group">
                <label for="header_2" class="text-dark"><b>Header 2</b>&nbsp;&nbsp;<span id="charCount2"
                    class="char-count"><b>(0/25)</b></span></label>
                <textarea class="form-control" id="header_2" name="header_2" rows="2" placeholder="Enter Header2...."
                  maxlength="25" oninput="updateCharCount('header_2','charCount2')"></textarea>
              </div>
            </div>
            <div class="col-md-3 cust-toggle1">
              <label for="header_2_flag" class="text-dark"><b>Header 2 Flag</b></label><br>
              <input type="checkbox" value=1 id="header_2_flag" data-toggle="toggle" data-onstyle="success"
                data-offstyle="danger" data-on="Active" data-off="Deactive" name="header_2_flag">
            </div>

            <div class="col-md-9">
              <div class="form-group">
                <label for="header_3" class="text-dark"><b>Header 3</b>&nbsp;&nbsp;<span id="charCount3"
                    class="char-count"><b>(0/25)</b></span></label>
                <textarea class="form-control" id="header_3" name="header_3" rows="2" placeholder="Enter Header3...."
                  maxlength="25" oninput="updateCharCount('header_3','charCount3')"></textarea>
              </div>
            </div>

            <div class="col-md-3 cust-toggle1">
              <label for="header_3_flag" class="text-dark"><b>Header 3 Flag</b></label><br>
              <input type="checkbox" value=1 id="header_3_flag" data-toggle="toggle" data-onstyle="success"
                data-offstyle="danger" data-on="Active" data-off="Deactive" name="header_3_flag">
            </div>

            <div class="col-md-9">
              <div class="form-group">
                <label for="header_4" class="text-dark"><b>Header 4</b>&nbsp;&nbsp;<span id="charCount4"
                    class="char-count"><b>(0/25)</b></span></label>
                <textarea class="form-control" id="header_4" name="header_4" rows="2" placeholder="Enter Header4...."
                  maxlength="25" oninput="updateCharCount('header_4','charCount4')"></textarea>
              </div>
            </div>

            <div class="col-md-3 cust-toggle1">
              <label for="header_4_flag" class="text-dark"><b>Header 4 Flag</b></label><br>
              <input type="checkbox" value=1 id="header_4_flag" data-toggle="toggle" data-onstyle="success"
                data-offstyle="danger" data-on="Active" data-off="Deactive" name="header_4_flag">
            </div>

            <div class="col-md-9">
              <div class="form-group">
                <label for="footer_1" class="text-dark"><b>Footer 1</b>&nbsp;&nbsp;<span id="charCount5"
                    class="char-count"><b>(0/25)</b></span></label>
                <textarea class="form-control" id="footer_1" name="footer_1" rows="2" placeholder="Enter Footer1...."
                  maxlength="25" oninput="updateCharCount('footer_1','charCount5')"></textarea>
              </div>
            </div>

            <div class="col-md-3 cust-toggle1">
              <label for="footer_1_flag" class="text-dark"><b>Footer 1 Flag</b></label><br>
              <input type="checkbox" value=1 id="footer_1_flag" data-toggle="toggle" data-onstyle="success"
                data-offstyle="danger" data-on="Active" data-off="Deactive" name="footer_1_flag">
            </div>

            <div class="col-md-9">
              <div class="form-group">
                <label for="footer_2" class="text-dark"><b>Footer 2</b>&nbsp;&nbsp;<span id="charCount6"
                    class="char-count"><b>(0/25)</b></span></label>
                <textarea class="form-control" id="footer_2" name="footer_2" rows="2" placeholder="Enter Footer2...."
                  maxlength="25" oninput="updateCharCount('footer_2','charCount6')"></textarea>
              </div>
            </div>

            <div class="col-md-3 cust-toggle1">
              <label for="footer_2_flag" class="text-dark"><b>Footer 2 Flag</b></label><br>
              <input type="checkbox" value=1 id="footer_2_flag" data-toggle="toggle" data-onstyle="success"
                data-offstyle="danger" data-on="Active" data-off="Deactive" name="footer_2_flag">
            </div>

            <div class="col-md-9">
              <div class="form-group">
                <label for="footer_3" class="text-dark"><b>Footer 3</b>&nbsp;&nbsp;<span id="charCount7"
                    class="char-count"><b>(0/25)</b></span></label>
                <textarea class="form-control" id="footer_3" name="footer_3" rows="2" placeholder="Enter Footer3...."
                  maxlength="25" oninput="updateCharCount('footer_3','charCount7')"></textarea>
              </div>
            </div>

            <div class="col-md-3 cust-toggle1">
              <label for="footer_3_flag" class="text-dark"><b>Footer 3 Flag</b></label><br>
              <input type="checkbox" value=1 id="footer_3_flag" data-toggle="toggle" data-onstyle="success"
                data-offstyle="danger" data-on="Active" data-off="Deactive" name="footer_3_flag">
            </div>

            <div class="col-md-9">
              <div class="form-group">
                <label for="footer_4" class="text-dark"><b>Footer 4</b>&nbsp;&nbsp;<span id="charCount8"
                    class="char-count"><b>(0/25)</b></span></label>
                <textarea class="form-control" id="footer_4" name="footer_4" rows="2" placeholder="Enter Footer4...."
                  maxlength="25" oninput="updateCharCount('footer_4','charCount8')"></textarea>
              </div>
            </div>

            <div class="col-md-3 cust-toggle1">
              <label for="footer_4_flag" class="text-dark"><b>Footer 4 Flag</b></label><br>
              <input type="checkbox" value=1 id="footer_4_flag" data-toggle="toggle" data-onstyle="success"
                data-offstyle="danger" data-on="Active" data-off="Deactive" name="footer_4_flag">
            </div>

            <div class="col-md-4 cust-toggle1" style="margin-left: 15vw;">
              <label for="in_on_off_flag" class="text-dark"><b>IN Receipt</b></label><br>
              <input type="checkbox" value="Y" id="in_on_off_flag" data-toggle="toggle" data-onstyle="success"
                data-offstyle="danger" data-on="Active" data-off="Deactive" name="in_on_off_flag">
            </div>

            <div class="col-md-4 cust-toggle1">
              <label for="out_on_off_flag" class="text-dark"><b>OUT Receipt</b></label><br>
              <input type="checkbox" value=1 id="out_on_off_flag" data-toggle="toggle" data-onstyle="success"
                data-offstyle="danger" data-on="Active" data-off="Deactive" name="out_on_off_flag">
            </div>

          </div>
          <div class="row mt-5">
            <div class="form-group col-md-3">
              <input type="submit" value="SUBMIT" class="btn btn-primary btn-block" style="margin-left: 32vw;" />
            </div>
          </div>
        </form>
      </div>

      <!-- Modal footer -->
      <!-- <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">
            Close
          </button>
        </div> -->
    </div>
  </div>
</div>

<script>
  $('#cust_name').change(function () {
    var customer_id = $(this).val()
    var tbody = $(".show_data tbody");
    $.ajax({
      type: "GET",
      url: "/header/header_footer_details",
      data: { customer_id: customer_id },
      success: function (response) {
        tbody.empty();
        if (response.suc > 0 && response.msg.length > 0) {
          $('#myBtn').hide()
          response.msg.forEach(function (item, index) {
            var flag = 1;
            var in_out_flag = 'Y';
            var row =
              "<tr>" +
              "<td class='text-dark'>" +
              (index + 1) +
              "</td>" +
              "<td class='text-dark'>" +
              item.customer_name +
              "</td>" +
              "<td>" +
              "<h3><span class='badge " + (item.header1_flag == flag ? 'badge-success' : 'badge-danger') + "'>" +
              (item.header1_flag == flag ? 'Active' : 'Deactive') +
              "</h3></span>" +
              "</td>" +
              "<td>" +
              "<h3><span class='badge " + (item.header2_flag == flag ? 'badge-success' : 'badge-danger') + "'>" +
              (item.header2_flag == flag ? 'Active' : 'Deactive') +
              "</h3></span>" +
              "</td>" +
              "<td>" +
              "<h3><span class='badge " + (item.header3_flag == flag ? 'badge-success' : 'badge-danger') + "'>" +
              (item.header3_flag == flag ? 'Active' : 'Deactive') +
              "</h3></span>" +
              "</td>" +
              "<td>" +
              "<h3><span class='badge " + (item.header4_flag == flag ? 'badge-success' : 'badge-danger') + "'>" +
              (item.header4_flag == flag ? 'Active' : 'Deactive') +
              "</h3></span>" +
              "</td>" +
              "<td>" +
              "<h3><span class='badge " + (item.footer1_flag == flag ? 'badge-success' : 'badge-danger') + "'>" +
              (item.footer1_flag == flag ? 'Active' : 'Deactive') +
              "</h3></span>" +
              "</td>" +
              "<td>" +
              "<h3><span class='badge " + (item.footer2_flag == flag ? 'badge-success' : 'badge-danger') + "'>" +
              (item.footer2_flag == flag ? 'Active' : 'Deactive') +
              "</h3></span>" +
              "</td>" +
              "<td>" +
              "<h3><span class='badge " + (item.footer3_flag == flag ? 'badge-success' : 'badge-danger') + "'>" +
              (item.footer3_flag == flag ? 'Active' : 'Deactive') +
              "</h3></span>" +
              "<td>" +
              "<h3><span class='badge " + (item.footer4_flag == flag ? 'badge-success' : 'badge-danger') + "'>" +
              (item.footer4_flag == flag ? 'Active' : 'Deactive') +
              "</h3></span>" +
              "</td>" +
              "<td>" +
              "<h3><span class='badge " + (item.IN_on_off == in_out_flag ? 'badge-success' : 'badge-danger') + "'>" +
              (item.IN_on_off == in_out_flag ? 'Active' : 'Deactive') +
              "</h3></span>" +
              "</td>" +
              "<td>" +
              "<h3><span class='badge " + (item.OUT_on_off == in_out_flag ? 'badge-success' : 'badge-danger') + "'>" +
              (item.OUT_on_off == in_out_flag ? 'Active' : 'Deactive') +
              "</h3></span>" +
              "</td>" +
              "<td><a href='/header/edit_header_footer_details?customer_id=" + item.customer_id + "' class='btn btn-info'><i class='fa fa-edit'></i></a></td>" +
              "</tr>";
            tbody.append(row);
          });
        } else {
          $('.show_data tbody').append(`
              <tr>
                <td colspan="13" class="text-danger text-center">No data found</td>
              </tr>
            `)
        }

      },
      error: function (error) {
        console.log(error);
        tbody.empty();

      },
    });

  });
</script>

<script>
  $(document).ready(function () {
    $("#myBtn").click(function () {
      $("#myModal").modal();
      // $("#myBtn").hide()
    });
  });
</script>

<script>
  function updateCharCount(textareaId, countId) {
    var textarea = document.getElementById(textareaId);
    var charCount = document.getElementById(countId);

    if (textarea && charCount) {
      var count = textarea.value.length;
      charCount.innerHTML = '<span style="font-weight: bold;">(' + count + '/25)</span>';
    }
  }
</script>